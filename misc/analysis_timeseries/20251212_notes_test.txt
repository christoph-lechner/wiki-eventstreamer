C. Lechner, 2025-12-12

Difference in reporting:
Note that C++ program currently "looks in the future", i.e. it reports the time where the window begins.
SQL reports the end time of the interval.
After fixing the C++ program, the reports number of events in the window should be identical.

## First difference
(note that `testdata.csv` was renamed to `testdata1.csv` after running these tests)
```
(venv) cl@cl-ThinkPad-X390:~/work/wikitest/misc/analysis_timeseries/build$ ./analyze_timeseries ../testdata.csv 
size of data loaded from file=7
Longest burst of events with duration 900 begins at
t0=899.000000, len=3
```

```
dev@192.168.2.253:dev> CREATE TABLE t (id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, col_t FLOAT);
CREATE TABLE
Time: 0.020s
dev@192.168.2.253:dev> \copy t(col_t) FROM 'misc/analysis_timeseries/testdata.csv' WITH (FORMAT csv,HEADER false);
COPY 7
Time: 0.006s
dev@192.168.2.253:dev> SELECT * FROM t;
+----+--------+
| id | col_t  |
|----+--------|
| 3  | 0.0    |
| 4  | 1.0    |
| 5  | 899.0  |
| 6  | 900.0  |
| 7  | 1000.0 |
| 8  | 1001.0 |
| 9  | 2000.0 |
+----+--------+
SELECT 7
Time: 0.021s
dev@192.168.2.253:dev> SELECT id,col_t, COUNT(*) OVER(ORDER BY col_t RANGE BETWEEN 900 PRECEDING AND CURRENT ROW) AS c FROM t ORDER BY id;
+----+--------+---+
| id | col_t  | c |
|----+--------+---|
| 3  | 0.0    | 1 |
| 4  | 1.0    | 2 |
| 5  | 899.0  | 3 |
| 6  | 900.0  | 4 |
| 7  | 1000.0 | 3 |
| 8  | 1001.0 | 4 |
| 9  | 2000.0 | 1 |
+----+--------+---+
SELECT 7
Time: 0.014s
dev@192.168.2.253:dev>
```

Fixed by inserting missing `1+` in C++ program.

## Second difference
```
(venv) cl@cl-ThinkPad-X390:~/work/wikitest/misc/analysis_timeseries/build$ ./analyze_timeseries ../testdata1a.csv 
size of data loaded from file=6
Longest burst of events with duration 900 begins at
t0=0.000000, len=3
```
```
dev@192.168.2.253:dev> \copy t(col_t) FROM 'misc/analysis_timeseries/testdata1a.csv' WITH (FORMAT csv,HEADER false);
COPY 6
Time: 0.013s
dev@192.168.2.253:dev> SELECT id,col_t, COUNT(*) OVER(ORDER BY col_t RANGE BETWEEN 90
 0 PRECEDING AND CURRENT ROW) AS c FROM t ORDER BY id;
+----+--------+---+
| id | col_t  | c |
|----+--------+---|
| 18 | 0.0    | 1 |
| 19 | 1.0    | 2 |
| 20 | 899.0  | 3 |
| 21 | 900.0  | 4 |
| 22 | 1000.0 | 3 |
| 23 | 2000.0 | 1 |
+----+--------+---+
SELECT 6
Time: 0.010s
dev@192.168.2.253:dev>
```


## Third dataset
File `testdata2.csv`
```
dev@192.168.2.253:dev> SELECT id,col_t, COUNT(*) OVER(ORDER BY col_t RANGE BETWEEN 90
 0 PRECEDING AND CURRENT ROW) AS c FROM t ORDER BY id;
+----+--------+---+
| id | col_t  | c |
|----+--------+---|
| 10 | 0.0    | 1 |
| 11 | 1.0    | 2 |
| 12 | 899.0  | 3 |
| 13 | 900.0  | 5 |
| 14 | 900.0  | 5 |
| 15 | 1000.0 | 4 |
| 16 | 1001.0 | 5 |
| 17 | 2000.0 | 1 |
+----+--------+---+
```
